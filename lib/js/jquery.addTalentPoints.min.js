
(function(a){a.fn.addTalentPoints=function(){return this.each(function(){var d,b=a(this).data("talents");d=a('<form style="display: none;" method="post" action="ajax/addCrafting.php"></form>');d.append("<table><tbody></tbody></table>");if(a.isEmptyObject(b)===false){for(var c in b){d.children("table").children("tbody").append("<tr><td>"+b[c]+'</td><td><input type="number" name="talentPoints['+c+']" /></td></tr>')}d.children("table").children("tbody").append('<tr><td><input type="hidden" name="craftingId" /><input type="submit" value="'+window.translations.add+'" /></td></tr>')}else{d.children("table").children("tbody").append("<tr><td>"+window.translations.noTalentPointsToAdd+"</td></tr>")}a(this).popup({content:d,dialog:{title:window.translations.addTalentPoints,open:function(){a(this).find("input[type=hidden]").val(parseInt(a(this).data("link").data("id"),10));a(this).on("submit",function(j){j.preventDefault();a(this).off("submit");var h={},m=a(this).serializeArray(),k,g,f,l=/(.*?)\[(.*?)\]/;for(g=0;g<m.length;g++){k=m[g];if(l.test(k.name)){f=l.exec(k.name);if(typeof h[f[1]]!=="object"){h[f[1]]={}}h[f[1]][f[2]]=k.value}else{h[k.name]=k.value}}a.post("ajax/addTalentPoints.php",{data:h},function(e){if(e.ok===true){document.location.reload()}},"json")})}}})})}}(jQuery));