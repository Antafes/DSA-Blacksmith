
$(function(){$("#addBlueprint").on("click",function(a){a.preventDefault();$("#addBlueprintPopup").dialog("open")});$("#addBlueprintPopup").dialog({title:$("#addBlueprintPopup").data("title"),modal:true,autoOpen:false,width:600,open:function(){$(this).children("form").on("submit",function(d){d.preventDefault();var c={},g=$(this).serializeArray(),f,b,a;for(b=0;b<g.length;b++){f=g[b];if(f.name.indexOf("[")===-1){c[f.name]=f.value}else{a=f.name.split("[");if(typeof c[a[0]]==="undefined"){c[a[0]]={}}c[a[0]][a[1].substr(0,a[1].length-1)]=f.value}}$.post("ajax/addBlueprint.php",{data:c},function(e){if(e.ok===true){document.location.reload()}},"json")});$("#itemSelect").on("change",function(){var d=$(this).find("option:selected"),f=d.data("itemtype"),c=$("#itemTypeSelect").children(),b=false,e=$("#addBlueprintPopup").find(".addBlueprint").children("tbody").children(),a="odd";if(d.data("damagetype")==="stamina"){$("#damageTypeSelect").children("option[value=damage]").prop("disabled",true);$("#damageTypeSelect").val("stamina")}else{$("#damageTypeSelect").children("option[value=damage]").prop("disabled",false)}c.each(function(){if($(this).data("type")!==f){$(this).hide()}else{$(this).show();if(!b){$("#itemTypeSelect").val($(this).attr("value"));b=true}}});e.not(".name, .items, .itemType").removeClass("odd even").hide();$.each(window.columsPerItemType[d.data("itemtype")],function(g,h){e.filter("."+h).show()});e.each(function(){if(!$(this).is(":visible")){return true}$(this).addClass(a);if(a==="odd"){a="even"}else{a="odd"}})});$("#itemSelect").trigger("change");$("#materialSelect").materialSelect({appendWeaponModificatorSelectTo:"#addBlueprintPopup",materials:window.materials,talents:window.talents,addLink:$("#addMaterialRow")});$("#techniqueSelect").techniqueSelect({data:window.techniques,addLink:$("#addTechniqueRow")})},close:function(){$(this).find("input:not([type=submit])").val("");$("#addMaterialRow").off("click");$(this).children("form").off("submit")}})});